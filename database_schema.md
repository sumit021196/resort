# Firestore Database Schema for Vegetable Inventory Management System

This document outlines the collections and their respective document structures for the Firestore database.

## Collections

### 1. `users`
Stores information about registered users and their roles.

-   **Document ID**: Firebase Auth `uid`
-   **Fields**:
    -   `uid`: (String) User ID from Firebase Authentication.
    -   `email`: (String) User's email address.
    -   `role`: (String) User's role (e.g., 'admin', 'purchaseManager', 'kitchenStaff').
    -   `name`: (String) User's full name.
    -   `createdAt`: (Timestamp) Timestamp of user creation.
    -   `updatedAt`: (Timestamp) Timestamp of last update.

### 2. `vegetables`
Master list of all vegetable items available for tracking.

-   **Document ID**: Auto-generated by Firestore
-   **Fields**:
    -   `name`: (String) Name of the vegetable (e.g., "Tomato", "Onion").
    -   `unit`: (String) Standard unit of measurement (e.g., "kg", "grams", "piece", "bunch").
    -   `category`: (String, Optional) e.g., "Leafy Greens", "Root Vegetables".
    -   `lowStockThreshold`: (Number) Quantity at which a low stock alert should be triggered for this vegetable.
    -   `description`: (String, Optional) Brief description or notes about the vegetable.
    -   `imageUrl`: (String, Optional) URL to an image of the vegetable.
    -   `isActive`: (Boolean) Whether the vegetable is currently active for purchasing/usage (default: true).
    -   `createdAt`: (Timestamp) Timestamp of creation.
    -   `updatedAt`: (Timestamp) Timestamp of last update.

### 3. `suppliers`
Information about vendors from whom vegetables are purchased.

-   **Document ID**: Auto-generated by Firestore
-   **Fields**:
    -   `name`: (String) Name of the supplier/vendor.
    -   `contactPerson`: (String, Optional) Name of the contact person at the supplier.
    -   `phone`: (String) Supplier's contact phone number.
    -   `email`: (String, Optional) Supplier's email address.
    -   `address`: (String, Optional) Supplier's physical address.
    -   `gstNumber`: (String, Optional) Supplier's GST number.
    -   `isActive`: (Boolean) Whether the supplier is currently active (default: true).
    -   `createdAt`: (Timestamp) Timestamp of creation.
    -   `updatedAt`: (Timestamp) Timestamp of last update.

### 4. `purchases`
Records of vegetable purchases.

-   **Document ID**: Auto-generated by Firestore
-   **Fields**:
    -   `vegetableId`: (String) Reference to the document ID in the `vegetables` collection.
    -   `vegetableName`: (String) Denormalized name of the vegetable for quick display.
    -   `quantity`: (Number) Quantity purchased.
    -   `unit`: (String) Unit of purchase (e.g., "kg", "piece").
    -   `ratePerUnit`: (Number) Cost per unit of the vegetable.
    -   `totalAmount`: (Number) Total cost for this purchase item (`quantity` * `ratePerUnit`).
    -   `supplierId`: (String) Reference to the document ID in the `suppliers` collection.
    -   `supplierName`: (String) Denormalized name of the supplier.
    -   `purchaseDate`: (Timestamp) Date of purchase.
    -   `invoiceNumber`: (String, Optional) Supplier's invoice number for this purchase.
    -   `invoicePhotoUrl`: (String, Optional) URL to the uploaded invoice photo (stored in Firebase Storage).
    -   `expiryDate`: (Timestamp, Optional) Expiry date for perishable items.
    -   `notes`: (String, Optional) Any notes related to this purchase.
    -   `purchasedByUid`: (String) `uid` of the Purchase Manager who made the entry (reference to `users` collection).
    -   `purchasedByName`: (String) Denormalized name of the Purchase Manager.
    -   `createdAt`: (Timestamp) Timestamp of when the purchase record was created.

### 5. `usage_log`
Records of daily vegetable usage by the kitchen.

-   **Document ID**: Auto-generated by Firestore
-   **Fields**:
    -   `vegetableId`: (String) Reference to the document ID in the `vegetables` collection.
    -   `vegetableName`: (String) Denormalized name of the vegetable.
    -   `quantityUsed`: (Number) Quantity of the vegetable used.
    -   `unit`: (String) Unit of usage (should match the vegetable's standard unit).
    -   `usageDate`: (Timestamp) Date when the vegetable was used.
    -   `notes`: (String, Optional) Notes about the usage (e.g., "Used for buffet lunch", "Staff meal", "Spoiled").
    -   `recordedByUid`: (String) `uid` of the Kitchen Staff who recorded the usage (reference to `users` collection).
    -   `recordedByName`: (String) Denormalized name of the Kitchen Staff.
    -   `createdAt`: (Timestamp) Timestamp of when the usage was logged.

### 6. `stock_levels`
Maintains the current stock level for each vegetable. This collection can be updated via backend triggers or functions whenever a new purchase or usage is logged.

-   **Document ID**: `vegetableId` (same as the ID from the `vegetables` collection for easy lookup).
-   **Fields**:
    -   `vegetableName`: (String) Denormalized name of the vegetable.
    -   `currentQuantity`: (Number) The current available quantity in stock.
    -   `unit`: (String) Standard unit of the vegetable.
    -   `lastPurchaseDate`: (Timestamp, Optional) Date of the last purchase of this vegetable.
    -   `lastUsageDate`: (Timestamp, Optional) Date of the last usage of this vegetable.
    -   `lastUpdated`: (Timestamp) Timestamp of when this stock record was last updated.

### 7. `audit_logs`
Logs significant actions performed within the system for auditing purposes.

-   **Document ID**: Auto-generated by Firestore
-   **Fields**:
    -   `action`: (String) Description of the action (e.g., "USER_LOGIN", "CREATE_PURCHASE", "UPDATE_VEGETABLE_STOCK", "DELETE_USER").
    -   `collectionName`: (String, Optional) The name of the primary collection affected (e.g., "users", "purchases").
    -   `documentId`: (String, Optional) The ID of the document affected in `collectionName`.
    -   `userId`: (String) `uid` of the user who performed the action.
    -   `userName`: (String, Optional) Denormalized name of the user.
    -   `timestamp`: (Timestamp) When the action occurred.
    -   `details`: (Object, Optional) Any additional details or data related to the action (e.g., old value vs new value for an update).

### 8. `app_settings` (Optional, Singleton Document)
For global application settings.

-   **Document ID**: e.g., `config`
-   **Fields**:
    -   `defaultLowStockThreshold`: (Number)
    -   `notificationPreferences`: (Object)
    -   `currencySymbol`: (String) e.g., "â‚¹", "$"
